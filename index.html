<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <link rel="stylesheet" href="style.css" />
        <title>East Falls Train Schedule</title>
        
        <script type="text/javascript">
            $(document).ready(function () {

                GetSchedule();

                function GetSchedule() {
                    var InboundAPI = "http://www3.septa.org/hackathon/NextToArrive/?req1=East%20Falls&req2=Market%20East&req3=2&callback=?";
                    var OutboundAPI = "http://www3.septa.org/hackathon/NextToArrive/?req1=Market%20East&req2=East%20Falls&req3=2&callback=?"
                    
                    $.getJSON(InboundAPI, function (data) {
                        $("#Inbound-List").empty();
                        var i = 0;
                        while(i < data.length)
                        {
                        	var lateText = "<span class = \"circleOnTime\">&nbsp;&nbsp;&nbsp;&nbsp;</span>";
							if (data[i].orig_delay != "On time")
							{
								lateText = "<span class = \"circleLate\">" + data[i].orig_delay.replace(" mins","") + "</span>";
							}
                        	$("#Inbound-List").append("<li>" + lateText + "<span class=\"StartTime\">" + data[i].orig_departure_time + "<span><br><span class=\"EndTime\">Arrives at " + data[i].orig_arrival_time + "</span><br><br></li>");
							i++;
                        }
                    });
					
					$.getJSON(OutboundAPI, function (data) {
                        $("#Outbound-List").empty();
                        var i = 0;
                        while(i < data.length)
                        {
                        	var lateText = "<span class = \"circleOnTime\">&nbsp;&nbsp;&nbsp;&nbsp;</span>";
							if (data[i].orig_delay != "On time")
							{
								
								lateText = "<span class = \"circleLate\">" + data[i].orig_delay.replace(" mins","") + "</span>";
							}
                        	$("#Outbound-List").append("<li>" + lateText + "<span class=\"StartTime\">" + data[i].orig_departure_time + "<span><br><span class=\"EndTime\">Arrives at " + data[i].orig_arrival_time + "</span><br><br></li>");
							i++;
                        }
                    });
                }

            });
        	
        </script>
        
    </head>
    <body>
        <h2 id="Inbound">East Falls Inbound</h2>
        <ul id="Inbound-List">
        	<li>
        		<span class="circleOnTime">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="StartTime">1:30 PM</span><br><span class="EndTime">Arrives 1:42 PM</span><br><br>
        	</li>
        	<li>
        		<span class="circleLate">5</span><span class="StartTime">2:30 PM<span><br><span class="EndTime">Arrives at 2:42 PM</span><br><br>
        	</li>
        </ul>
        <h2 id="Outbound">Market East Outbound</h2>
        <ul id="Outbound-List">
        	<li>
        		<h3>Leaves 1:28 PM Arrives 1:38 PM</h3>
        		<p>On Time</p>
        	</li>
        	<li>
        		<h3>Leaves 2:28 PM Arrives 2:38 PM</h3>
        		<p>5 Minutes Late</p>
        	</li>
        </ul>
    </body>
</html>
